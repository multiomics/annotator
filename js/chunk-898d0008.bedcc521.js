(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-898d0008"],{"34f2":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"srdf-container"},[a("div",{staticClass:"browse-data-container"},[a("Row",{staticStyle:{"margin-bottom":"20px"}},[a("div",{staticClass:"title"},[e._v("\n               Omics Sample to Data Annotation Tool\n            ")]),a("div",{staticClass:"upload"},[a("a",{staticClass:"file",attrs:{href:"javascript:;"}},[a("i",{staticClass:"ivu-icon ivu-icon-ios-cloud-upload-outline"}),a("span",{staticStyle:{"margin-left":"5px"}},[e._v("Upload SRDF File")]),a("input",{attrs:{type:"file",name:"",id:"file"},on:{change:e.readFile}})])])]),a("Row",[a("selfTable",{attrs:{name:e.name,height:e.tableHeight,loading:e.loading,columns:e.sampleCol,addedCol:e.addedCol,data:e.sampleData}}),a("div",{staticClass:"button-wrapper"},[a("div",{staticClass:"search-button"},[a("Button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("Back")])],1),e.sampleCol.length>0&&e.sampleData.length>0?a("div",{staticClass:"search-button right"},[a("Button",{attrs:{type:"primary"},on:{click:e.annotationSave}},[e._v("Save")]),a("Button",{attrs:{type:"primary"},on:{click:e.annotationConfirm}},[e._v("Confirm")])],1):e._e()])],1)],1)])},o=[],i=(a("4917"),a("ac6a"),a("7f7f"),a("a481"),a("28a5"),a("96cf"),a("3b8d")),r=a("1ea4"),s=(a("3e8f"),{name:"srdf",data:function(){return{name:"Omics SDRF Reader",loading:!1,sampleCol:[],sampleData:[],keyList:[],addedCol:[],screenHeight:document.documentElement.clientHeight,getTableDataAPI:this.$store.state.baseApiURL+"/properties/getPropertiesFromText",getAddedColAPI:this.$store.state.baseApiURL+"/properties/getProperties"}},beforeRouteUpdate:function(e,t,a){},components:{selfTable:r["a"]},methods:{readFile:function(e){var t=this,a=e.target.files||e.dataTransfer.files;if(a.length){var n=new FileReader;n.readAsText(a[0],"UTF-8"),this.loading=!0,this.sampleCol=[],this.sampleData=[],this.keyList=[],this.addedCol=[],n.onload=function(){var a=Object(i["a"])(regeneratorRuntime.mark((function a(n){var o,i,r,s,l,c,d,u,p,m,h,f,g,b,y;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:a.prev=0,o=n.currentTarget.result.split("\n"),a.t0=regeneratorRuntime.keys(o);case 3:if((a.t1=a.t0()).done){a.next=27;break}if(i=a.t1.value,0!=i){a.next=18;break}for(l in r=o[i].split("\t"),s="",r)s+=r[l]+", ";return c=s.slice(0,s.length-2),d={sdrf_properties:c},a.next=13,t.$http.get(t.getTableDataAPI,{params:d});case 13:for(p in u=a.sent,t.sampleCol.push({name:"#",key:"index",required:!0}),u.body)m={name:u.body[p].freeTextColumn,key:u.body[p].freeTextColumn.replace(/\s+/g,"")+Math.floor(1e5+9e5*Math.random()),required:!1,typeNode:u.body[p].templateColumn.typeNode?u.body[p].templateColumn.typeNode:"",ontologyTerm:u.body[p].templateColumn.ontologyTerm?u.body[p].templateColumn.ontologyTerm:null,searchable:u.body[p].templateColumn.searchable},t.keyList.push(m),t.sampleCol.push(m);a.next=25;break;case 18:if(o[i]){a.next=21;break}return t.$Modal.warning({title:"WARNING",content:"<p>The current file has some empty lines and the end, please remove it. Check specification</p>",onOk:function(){}}),a.abrupt("continue",3);case 21:for(g in h=o[i].split("\t"),f={},h)f.index=parseInt(i),f[t.keyList[g].key]={value:h[g],checked:!0,active:!1,required:t.keyList[g].required};t.sampleData.push(f);case 25:a.next=3;break;case 27:return a.next=29,t.$http.get(t.getAddedColAPI);case 29:for(y in b=a.sent,b.body)b.body[y].key=b.body[y].name.replace(/\s+/g,"")+Math.floor(1e5+9e5*Math.random()),b.body[y].required=!1;t.addedCol=b.body,t.loading=!1,e.target.value="",a.next=40;break;case 36:a.prev=36,a.t2=a["catch"](0),t.$Message.error({content:"File Read Error",duration:2}),console.log(a.t2);case 40:case"end":return a.stop()}}),a,null,[[0,36]])})));return function(e){return a.apply(this,arguments)}}()}},setClassName:function(e){return e.match("sourcename")||e.match("characteristics")?"blue":e.match("assayname")||e.match("comment")?"green":"red"},back:function(){var e=this,t=localStorage.getItem("projectAccession");t?this.$Modal.confirm({title:"Uncompleted Annotaion",content:"<p>Do you want to delete the uncompleted annotation?</p>",onOk:function(){localStorage.clear(),e.$router.push({name:"index"})},onCancel:function(){}}):this.$router.push({name:"index"})},annotationConfirm:function(){var e=this;this.$Modal.confirm({title:"Finish Annotation",content:"<p>Do you want to submit this annotation?</p>",onOk:function(){e.$bus.$emit("annotation-confirm")},onCancel:function(){}})},annotationSave:function(){this.$bus.$emit("annotation-save")},getTableData:function(){console.log("getTableData sampleCol",this.sampleCol);var e={sdrf_properties:"characteristics[organism], characteristics[organism part]"};this.$http.get(this.getTableDataAPI,{params:e}).then((function(e){console.log(e.body)}),(function(e){this.fileListLoading=!1}))}},watch:{},computed:{tableHeight:function(){var e=300;return this.screenHeight-180-138-20-55-32>e?this.screenHeight-180-138-20-55-32:e}},mounted:function(){var e=this;window.onresize=function(){e.screenHeight=document.documentElement.clientHeight}},created:function(){},beforeDestroy:function(){}}),l=s,c=(a("8a9c"),a("7e7f"),a("2877")),d=Object(c["a"])(l,n,o,!1,null,"61810130",null);t["default"]=d.exports},"3e8f":function(e,t){},"7e7f":function(e,t,a){"use strict";var n=a("da2a"),o=a.n(n);o.a},"8a9c":function(e,t,a){"use strict";var n=a("bdaa"),o=a.n(n);o.a},bdaa:function(e,t,a){},da2a:function(e,t,a){}}]);
//# sourceMappingURL=chunk-898d0008.bedcc521.js.map